{"remainingRequest":"I:\\workstation\\web\\cmd_admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!I:\\workstation\\web\\cmd_admin\\src\\components\\task.vue?vue&type=script&lang=js&","dependencies":[{"path":"I:\\workstation\\web\\cmd_admin\\src\\components\\task.vue","mtime":1590418114926},{"path":"I:\\workstation\\web\\cmd_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"I:\\workstation\\web\\cmd_admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"I:\\workstation\\web\\cmd_admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"I:\\workstation\\web\\cmd_admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBUYXNrTGluZSBmcm9tICIuL1Rhc2tMaW5lIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJwppbXBvcnQgT3V0cHV0IGZyb20gIi4vT3V0cHV0IjsKCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJ0YXNrIiwKICAgIGNvbXBvbmVudHM6IHtPdXRwdXQsIFRhc2tMaW5lfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdGFibGVEYXRhOiBbewogICAgICAgICAgICAgICAgYTogMSwgYjogMgogICAgICAgICAgICB9XSwKICAgICAgICAgICAgY3JlYXRlRGF0YTogewogICAgICAgICAgICAgICAgaWQ6JycsCiAgICAgICAgICAgICAgICBuYW1lOiAiIiwKICAgICAgICAgICAgICAgIGRpcjogJycsCiAgICAgICAgICAgICAgICBjb21tYW5kOiAnJywKICAgICAgICAgICAgICAgIGtlZXBUeXBlOjAsCiAgICAgICAgICAgICAgICB0aW1pbmc6MCwKICAgICAgICAgICAgICAgIHJlbWFyazogJycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdXNlRGF0YTogewogICAgICAgICAgICAgICAgaWQ6JycsCiAgICAgICAgICAgICAgICBuYW1lOiAiIiwKICAgICAgICAgICAgICAgIGRpcjogJycsCiAgICAgICAgICAgICAgICBjb21tYW5kOiAnJywKICAgICAgICAgICAgICAgIGtlZXBUeXBlOjAsCiAgICAgICAgICAgICAgICB0aW1pbmc6MCwKICAgICAgICAgICAgICAgIHJlbWFyazogJycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaXNTaG93OiBmYWxzZSwKICAgICAgICAgICAgaXNTaG93T3V0cHV0OiBmYWxzZSwKICAgICAgICAgICAgb3V0cHV0VGFzazoge30KICAgICAgICB9CiAgICB9LAogICAgY3JlYXRlZCgpIHsKICAgICAgICB0aGlzLmluaXQoKQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBjbG9zZUl0OiBmdW5jdGlvbiAocmVmcmVzaCkgewogICAgICAgICAgICB0aGlzLmlzU2hvdyA9IGZhbHNlOwogICAgICAgICAgICBpZiAocmVmcmVzaCkgewogICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlU3VjY2VzcygpCiAgICAgICAgICAgICAgICB0aGlzLmluaXQoKTsKICAgICAgICAgICAgfQoKICAgICAgICB9LAogICAgICAgIHVwZGF0ZVRhc2s6ZnVuY3Rpb24odGFzayl7CgogICAgICAgICAgICB0aGlzLnVzZURhdGEuaWQ9dGFzay5JZAogICAgICAgICAgICB0aGlzLnVzZURhdGEubmFtZT10YXNrLk5hbWUKICAgICAgICAgICAgdGhpcy51c2VEYXRhLmRpcj10YXNrLkRpcgogICAgICAgICAgICB0aGlzLnVzZURhdGEuY29tbWFuZD10YXNrLkNvbW1hbmQKICAgICAgICAgICAgdGhpcy51c2VEYXRhLmtlZXBUeXBlPXRhc2suS2VlcFR5cGUKICAgICAgICAgICAgdGhpcy51c2VEYXRhLnRpbWluZz10YXNrLlRpbWluZwogICAgICAgICAgICB0aGlzLnVzZURhdGEucmVtYXJrPXRhc2suUmVtYXJrCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMudXNlRGF0YSkKICAgICAgICAgICAgdGhpcy5pc1Nob3cgPSB0cnVlCgogICAgICAgIH0sCiAgICAgICAgY2xvc2VPdXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdGhpcy5pc1Nob3dPdXRwdXQgPSBmYWxzZTsKCiAgICAgICAgfSwKICAgICAgICBPcGVub3V0cHV0OiBmdW5jdGlvbiAodGFzaykgewogICAgICAgICAgICB0aGlzLmlzU2hvd091dHB1dCA9IHRydWUKICAgICAgICAgICAgdGhpcy5vdXRwdXRUYXNrID0gdGFzawogICAgICAgIH0sCiAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uICh0YXNrRGF0YSkgewogICAgICAgICAgICBsZXQgdnVlID0gdGhpczsKICAgICAgICAgICAgdnVlLmNvbmZpcm1BY3Rpb24oZnVuY3Rpb24gKCkgewogICAgICAgICAgICBheGlvcy5nZXQoImh0dHA6Ly8xMjcuMC4wLjE6MzAwMC9hcGkvdGFzay9zdGFydD9pZD0iICsgdGFza0RhdGEuSUQsKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDApIHsKICAgICAgICAgICAgICAgICAgICB2dWUubWVzc2FnZVN1Y2Nlc3MoKQogICAgICAgICAgICAgICAgICAgIHZ1ZS5pbml0KCkKICAgICAgICAgICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgICAgICAgICB2dWUubWVzc2FnZUVycm9yKHJlcy5kYXRhLm1zZykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGtpbGw6IGZ1bmN0aW9uICh0YXNrRGF0YSkgewogICAgICAgICAgICBsZXQgdnVlID0gdGhpczsKICAgICAgICAgICAgdnVlLmNvbmZpcm1BY3Rpb24oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgYXhpb3MuZ2V0KCJodHRwOi8vMTI3LjAuMC4xOjMwMDAvYXBpL3Rhc2sva2lsbD9pZD0iICsgdGFza0RhdGEuSUQsKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZ1ZS5tZXNzYWdlU3VjY2VzcygpCiAgICAgICAgICAgICAgICAgICAgICAgIHZ1ZS5pbml0KCkKICAgICAgICAgICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZ1ZS5tZXNzYWdlRXJyb3IocmVzLmRhdGEubXNnKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBkZWxldGVUYXNrOiBmdW5jdGlvbiAodGFza0RhdGEpIHsKICAgICAgICAgICAgbGV0IHZ1ZSA9IHRoaXM7CiAgICAgICAgICAgIHZ1ZS5jb25maXJtQWN0aW9uKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgYXhpb3MuZGVsZXRlKCJodHRwOi8vMTI3LjAuMC4xOjMwMDAvYXBpL3Rhc2s/aWQ9IiArIHRhc2tEYXRhLklELCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuY29kZSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgdnVlLm1lc3NhZ2VTdWNjZXNzKCkKICAgICAgICAgICAgICAgICAgICB2dWUuaW5pdCgpCiAgICAgICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdnVlLm1lc3NhZ2VFcnJvcihyZXMuZGF0YS5tc2cpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGxldCB2dWUgPSB0aGlzCiAgICAgICAgICAgIGF4aW9zLmdldCgiaHR0cDovLzEyNy4wLjAuMTozMDAwL2FwaS90YXNrIiwpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgdnVlLnRhYmxlRGF0YSA9IHJlcy5kYXRhLmRhdGEKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIG1lc3NhZ2VTdWNjZXNzOiBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICAgIGlmICghbXNnKSB7CiAgICAgICAgICAgICAgICBtc2cgPSAn5pON5L2c5oiQ5YqfJwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgbWVzc2FnZTogbXNnLAogICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgbWVzc2FnZUVycm9yOiBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgICAgIGlmICghbXNnKSB7CiAgICAgICAgICAgICAgICBtc2cgPSAn5pON5L2c5aSx6LSlJwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgbWVzc2FnZTogbXNnLAogICAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgY29uZmlybUFjdGlvbjogZnVuY3Rpb24gKGNhbGxiYWNrLCBjb250ZW50KSB7CiAgICAgICAgICAgIGlmICghY29udGVudCkgewogICAgICAgICAgICAgICAgY29udGVudCA9ICfnoa7orqTmk43kvZw/JwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuJGFsZXJ0KGNvbnRlbnQsICfmj5DnpLonLCB7CiAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgICAgICAgICBjYWxsYmFjazogYWN0aW9uID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uID09PSAnY29uZmlybScpewogICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9Cgp9Cg=="},{"version":3,"sources":["task.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"task.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <div>\r\n        <task-line :data=\"useData\" v-if=\"isShow\" @closeIt=\"closeIt\"></task-line>\r\n        <Output :task=\"outputTask\" v-if=\"isShowOutput\" @closeOut=\"closeOut\"></Output>\r\n        <el-container>\r\n            <el-header></el-header>\r\n            <el-main style=\"text-align: center\">\r\n                <div align=\"right\"></div>\r\n                <div align=\"right\">\r\n                    <el-button @click=\"init\">刷新</el-button>\r\n                    <el-button @click=\"isShow=true\">添加</el-button>\r\n                </div>\r\n\r\n                <el-table\r\n                        :data=\"tableData\"\r\n                        style=\"width: 80%;text-align: center\">\r\n                    <el-table-column\r\n                            prop=\"Name\"\r\n                            label=\"任务名称\"\r\n                            width=\"180\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"UpdatedAt\"\r\n                            label=\"更新时间\"\r\n                            width=\"180\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"PID\"\r\n                            label=\"PID\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n\r\n                            label=\"状态\">\r\n                        <template slot-scope=\"scope\">\r\n                            <el-tag v-show=\"scope.row.State===0\">未开始</el-tag>\r\n                            <el-tag v-show=\"scope.row.State===1\">进行中</el-tag>\r\n                            <el-tag v-show=\"scope.row.State===2\">已完成</el-tag>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            label=\"重启策略\">\r\n                        <template slot-scope=\"scope\">\r\n                            <el-tag v-show=\"scope.row.KeepType===1\">定时重启{{scope.row.Timing}}</el-tag>\r\n                            <el-tag v-show=\"scope.row.KeepType===2\">保持运行</el-tag>\r\n\r\n                        </template>\r\n                    </el-table-column>\r\n\r\n                    <el-table-column label=\"操作\">\r\n                        <template slot-scope=\"scope\">\r\n                            <el-button type=\"text\" size=\"small\" @click=\"start(scope.row)\"\r\n                                       v-if=\"scope.row.State===0||scope.row.State===2\">start\r\n                            </el-button>\r\n                            <el-button type=\"text\" size=\"small\" @click=\"kill(scope.row)\" v-if=\"scope.row.State===1\">\r\n                                kill\r\n                            </el-button>\r\n                            <el-button type=\"text\" size=\"small\" @click=\"Openoutput(scope.row)\">查看</el-button>\r\n                            <el-button type=\"text\" size=\"small\" @click=\"updateTask(scope.row)\">编辑</el-button>\r\n                            <el-button type=\"text\" size=\"small\" @click=\"deleteTask(scope.row)\">删除</el-button>\r\n                        </template>\r\n                    </el-table-column>\r\n                </el-table>\r\n            </el-main>\r\n\r\n        </el-container>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\n    import TaskLine from \"./TaskLine\";\r\n    import axios from 'axios'\r\n    import Output from \"./Output\";\r\n\r\n    export default {\r\n        name: \"task\",\r\n        components: {Output, TaskLine},\r\n        data() {\r\n            return {\r\n                tableData: [{\r\n                    a: 1, b: 2\r\n                }],\r\n                createData: {\r\n                    id:'',\r\n                    name: \"\",\r\n                    dir: '',\r\n                    command: '',\r\n                    keepType:0,\r\n                    timing:0,\r\n                    remark: ''\r\n                },\r\n                useData: {\r\n                    id:'',\r\n                    name: \"\",\r\n                    dir: '',\r\n                    command: '',\r\n                    keepType:0,\r\n                    timing:0,\r\n                    remark: ''\r\n                },\r\n                isShow: false,\r\n                isShowOutput: false,\r\n                outputTask: {}\r\n            }\r\n        },\r\n        created() {\r\n            this.init()\r\n        },\r\n        methods: {\r\n            closeIt: function (refresh) {\r\n                this.isShow = false;\r\n                if (refresh) {\r\n                    this.messageSuccess()\r\n                    this.init();\r\n                }\r\n\r\n            },\r\n            updateTask:function(task){\r\n\r\n                this.useData.id=task.Id\r\n                this.useData.name=task.Name\r\n                this.useData.dir=task.Dir\r\n                this.useData.command=task.Command\r\n                this.useData.keepType=task.KeepType\r\n                this.useData.timing=task.Timing\r\n                this.useData.remark=task.Remark\r\n                console.log(this.useData)\r\n                this.isShow = true\r\n\r\n            },\r\n            closeOut: function () {\r\n                this.isShowOutput = false;\r\n\r\n            },\r\n            Openoutput: function (task) {\r\n                this.isShowOutput = true\r\n                this.outputTask = task\r\n            },\r\n            start: function (taskData) {\r\n                let vue = this;\r\n                vue.confirmAction(function () {\r\n                axios.get(\"http://127.0.0.1:3000/api/task/start?id=\" + taskData.ID,).then(function (res) {\r\n                    if (res.data.code == 0) {\r\n                        vue.messageSuccess()\r\n                        vue.init()\r\n                    }else {\r\n                        vue.messageError(res.data.msg)\r\n                    }\r\n                })\r\n                })\r\n            },\r\n            kill: function (taskData) {\r\n                let vue = this;\r\n                vue.confirmAction(function () {\r\n                    axios.get(\"http://127.0.0.1:3000/api/task/kill?id=\" + taskData.ID,).then(function (res) {\r\n                        if (res.data.code == 0) {\r\n                            vue.messageSuccess()\r\n                            vue.init()\r\n                        }else {\r\n                            vue.messageError(res.data.msg)\r\n                        }\r\n                    })\r\n                })\r\n            },\r\n            deleteTask: function (taskData) {\r\n                let vue = this;\r\n                vue.confirmAction(function () {\r\n                axios.delete(\"http://127.0.0.1:3000/api/task?id=\" + taskData.ID,).then(function (res) {\r\n                    if (res.data.code == 0) {\r\n                        vue.messageSuccess()\r\n                        vue.init()\r\n                    }else {\r\n                        vue.messageError(res.data.msg)\r\n                    }\r\n                })\r\n                })\r\n            },\r\n            init: function () {\r\n                let vue = this\r\n                axios.get(\"http://127.0.0.1:3000/api/task\",).then(function (res) {\r\n                    vue.tableData = res.data.data\r\n                })\r\n            },\r\n            messageSuccess: function (msg) {\r\n                if (!msg) {\r\n                    msg = '操作成功'\r\n                }\r\n                this.$message({\r\n                    message: msg,\r\n                    type: 'success'\r\n                });\r\n            },\r\n            messageError: function (msg) {\r\n                if (!msg) {\r\n                    msg = '操作失败'\r\n                }\r\n                this.$message({\r\n                    message: msg,\r\n                    type: 'warning'\r\n                });\r\n            },\r\n            confirmAction: function (callback, content) {\r\n                if (!content) {\r\n                    content = '确认操作?'\r\n                }\r\n                this.$alert(content, '提示', {\r\n                    confirmButtonText: '确定',\r\n                    callback: action => {\r\n                        if (action === 'confirm'){\r\n                            callback()\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]}]}